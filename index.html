<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map test</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet"> 
    <style>
        *{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Fira sans', sans-serif;
        }
        .mapcontainer{
            height: 100vh;
            margin: auto;
            position: relative;
            width: 100%;
            overflow: hidden;
        }
        #mapid{
            height: 100%;
            width: 100%;
            position: relative;
        }
        .Lsidepanel{
            width: 40%;
            max-width: 550px;
            height: 100%;
            background: white;
            position: absolute;
            top: 0;
            right: 0;
            z-index: 7000;
            opacity: 0.5;
            transition: 0.6s ease;
            transform: translateX(200%);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border-left: 1px solid rgb(167, 167, 167);
        }
        .LsidepanelInner{
            width: 100%;
            padding: 6%;
            overflow: auto
        }
        .Lsidepanel.active{
            opacity: 1;
            transform: translateX(0)
        }
        .popupCustom .leaflet-popup-content-wrapper {
        background: #87c0e0;
        color: #234c5e;
        }
        .leaflet-popup-tip{
            display: none;
        }
        .Lheader{
            width: 100%;
            display: flex;
            justify-content: flex-end;
            align-items: center;
        }
        .LbtnAll{
            border: 1px solid rgb(148, 147, 147);
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            margin-right: 2rem;
            cursor: pointer;
        }
        .LcloseMenu, .LcloseMenuList{
            cursor: pointer;
        }
        .Ltitle{
            margin: 4rem 0 2rem 0;
            font-weight: 800;
            font-size: 1.8rem;
            color: #2d353f;
        }
        .Linformation, .Llist{
            padding: 1rem 0;
        }
        .Ladress, .Lphone, .Lwebsite{
            display: flex;
            align-items: center;
            margin: 2rem 0 1rem 0;
        }
        .LsubTxt{
            margin-left: 0.5rem;
        }
        .Ladress svg, .Lwebsite svg, .Lphone svg{
            flex-shrink: 0;
        }
        .Lwebsite a{
            color: #16AFD1;
        }

        .LfilterService, .LfilterHebergement, .LfilterRestauration, .LfilterTout, .LfilterActivite{
            border: 2px solid rgba(22, 175, 209, 1);
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            cursor: pointer;
            margin: 1rem 0;
            color: rgba(22, 175, 209, 1);
        }

        .activeFilter{
            border: 3px solid #307199;
            color: #307199;
            font-weight: 600;
        }
        @media only screen and (max-width: 1024px) {
            .LsubTxt{
                font-size: 14px;
            }
        }
        @media only screen and (max-width: 768px) {
            .Ladress svg{
                display: none;
            }
            .Ladress .LsubTxt{
                margin-left: 0;
                text-align: center;
            }
            .Ltitle{
            font-size: 1.4rem;
            }
            .Lsidepanel{
                width: 50%;
            }
        }
    </style>
</head>
<body>
    <div class="mapcontainer">
        <div id="mapid"></div>
        <div class="Lsidepanel"></div>
    </div>
</body>
<script>

    const svgBlue = '<svg width="26" height="41" viewBox="0 0 26 41" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19 13.5C19 16.5376 16.5376 19 13.5 19C10.4624 19 8 16.5376 8 13.5C8 10.4624 10.4624 8 13.5 8C16.5376 8 19 10.4624 19 13.5Z" fill="white"/><path d="M13.3619 39.3378C13.2153 39.5682 13.0946 39.7565 13.0036 39.898C12.9126 39.7565 12.7919 39.5682 12.6452 39.3378C12.2905 38.7806 11.7835 37.9772 11.1752 36.9925C9.95834 35.023 8.33623 32.3293 6.71445 29.4318C5.09221 26.5334 3.47258 23.4351 2.25921 20.6553C1.04034 17.863 0.25 15.4322 0.25 13.8523C0.25 9.09195 1.87241 5.70244 4.2625 3.49961C6.6568 1.2929 9.84296 0.257417 13 0.250001C16.157 0.257417 19.3432 1.2929 21.7375 3.49961C24.1276 5.70244 25.75 9.09195 25.75 13.8523C25.75 15.4322 24.9601 17.863 23.7419 20.6554C22.5293 23.4351 20.9105 26.5335 19.2892 29.4318C17.6684 32.3294 16.0472 35.0231 14.831 36.9926C14.223 37.9772 13.7164 38.7807 13.3619 39.3378ZM13.0074 8.54761C10.379 8.54761 8.25114 10.6755 8.25114 13.3039C8.25114 15.932 10.3788 18.0601 13 18.0601C15.6278 18.0601 17.7637 15.9328 17.7637 13.3039C17.7637 10.6755 15.6358 8.54761 13.0074 8.54761Z" fill="#16AFD1" stroke="white" stroke-width="0.5"/></svg>';
    const baseSvg = 'data:image/svg+xml;base64,' + btoa(svgBlue);

    const svgDark = '<svg width="26" height="41" viewBox="0 0 26 41" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19 13.5C19 16.5376 16.5376 19 13.5 19C10.4624 19 8 16.5376 8 13.5C8 10.4624 10.4624 8 13.5 8C16.5376 8 19 10.4624 19 13.5Z" fill="white"/><path d="M13.3619 39.3378C13.2153 39.5682 13.0946 39.7565 13.0036 39.898C12.9126 39.7565 12.7919 39.5682 12.6452 39.3378C12.2905 38.7806 11.7835 37.9772 11.1752 36.9925C9.95834 35.023 8.33623 32.3293 6.71445 29.4318C5.09221 26.5334 3.47258 23.4351 2.25921 20.6553C1.04034 17.863 0.25 15.4322 0.25 13.8523C0.25 9.09195 1.87241 5.70244 4.2625 3.49961C6.6568 1.2929 9.84296 0.257417 13 0.250001C16.157 0.257417 19.3432 1.2929 21.7375 3.49961C24.1276 5.70244 25.75 9.09195 25.75 13.8523C25.75 15.4322 24.9601 17.863 23.7419 20.6554C22.5293 23.4351 20.9105 26.5335 19.2892 29.4318C17.6684 32.3294 16.0472 35.0231 14.831 36.9926C14.223 37.9772 13.7164 38.7807 13.3619 39.3378ZM13.0074 8.54761C10.379 8.54761 8.25114 10.6755 8.25114 13.3039C8.25114 15.932 10.3788 18.0601 13 18.0601C15.6278 18.0601 17.7637 15.9328 17.7637 13.3039C17.7637 10.6755 15.6358 8.54761 13.0074 8.54761Z" fill="#307199" stroke="white" stroke-width="0.5"/></svg>';
    const activeSvg = 'data:image/svg+xml;base64,' + btoa(svgDark);

    const sidepanel = document.querySelector('.Lsidepanel')

    let clickedMarker;
    
    const activeIcon = new L.Icon({
        iconUrl: activeSvg,
        shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
        // iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
    });

    const baseIcon = new L.Icon({
        iconUrl: baseSvg,
        shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
    });

    const mymap = L.map('mapid',{
        center : [45.6284600, -1.0281000],
        zoom : 11,
        minZoom : 10,
        zoomControl : false,
    })

    const popup = L.popup()

    const customOptions =
        {
        'maxWidth': '100%',
        'width': '100%',
        'className' : 'popupCustom'
        }

    const tileUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'

    L.tileLayer(tileUrl, { 
        attribution : '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
        maxZoom: 18,
        zoomOffest: -1,
        }).addTo(mymap)


    let geojson = {
        type: "FeatureCollection",
        features: []
    }

    fetch('https://script.googleusercontent.com/macros/echo?user_content_key=Tvu5ydypmc9FPX_faTChkkTS9UhxK1WQ7ETa2KVwqbPDFwaMBofMOuNuw24yUiBWKTbagYLNz_-0uLQtK0qkGpki1TsG8wQem5_BxDlH2jW0nuo2oDemN9CCS2h10ox_1xSncGQajx_ryfhECjZEnLqrBgluDekbTIPQZNVHGf7dfDkcJ3TALlZKQbnzqASdeoNp780cEthHw__5aZrAQFFrGqk7FSJR&lib=M1-0sR9glFGJodTTkG848NlT3K2hnuyIu')
    .then(response => response.json())
    .then(obj => {
        obj[0].data.forEach(item => {
            const coord = item.coordinates.split(',')
            let parseCoord = [parseFloat(coord[0]), parseFloat(coord[1])]
            let newData = {
                type : item.type,
                properties : {
                    category : item.category,
                    name : item.name,
                    image : item.image,
                    adress : item.adress,
                    phone : item.phone,
                    website : item.website,
                },
                geometry: {
                    type : item.geometry__type,
                    coordinates : parseCoord
                }
            }
            geojson.features.push(newData)
        })

        const eachFeatureCode = function(feature, layer){      
                    if(feature.geometry.type === 'Point'){
                    layer.on('click', function(e){
                        if(clickedMarker){
                            clickedMarker.setIcon(baseIcon);
                        }
                        e.target.setIcon(activeIcon);
                        clickedMarker = e.target;
                        
                        L.Map.prototype.setViewOffset = function (latlng, offset, targetZoom) {
                            var targetPoint = this.project(latlng, targetZoom).subtract(offset),
                            targetLatLng = this.unproject(targetPoint, targetZoom);
                            return this.setView(targetLatLng, targetZoom);
                        }

                        mymap.setViewOffset(e.target.getLatLng(),[-100, 0],17)

                        sidepanel.classList.add('active');
                        sidepanel.innerHTML = `
                            <div class="LsidepanelInner">
                                <div class="Lheader">
                                    <div class="LbtnAll">Tout voir</div>
                                    <svg class="LcloseMenu" width="20" height="20" viewBox="0 0 123 123" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect x="19.7809" y="0.688812" width="145" height="27" rx="13.5" transform="rotate(45 19.7809 0.688812)" fill="#4D4949"/>
                                    <rect x="1.00012" y="102.53" width="145" height="27" rx="13.5" transform="rotate(-45 1.00012 102.53)" fill="#4D4949"/>
                                    </svg>
                                </div>
                                <h2 class="Ltitle">${feature.properties.name}</h2>
                                <img src="${feature.properties.image}" width="100%" height="auto">
                                <div class="Linformation">
                                    <div class="Ladress">
                                        <svg width="27" height="27" viewBox="0 0 27 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M23.625 11.25C23.625 19.125 13.5 25.875 13.5 25.875C13.5 25.875 3.375 19.125 3.375 11.25C3.375 8.56468 4.44174 5.98935 6.34054 4.09054C8.23935 2.19174 10.8147 1.125 13.5 1.125C16.1853 1.125 18.7606 2.19174 20.6595 4.09054C22.5583 5.98935 23.625 8.56468 23.625 11.25Z" stroke="#307199" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M13.5 14.625C15.364 14.625 16.875 13.114 16.875 11.25C16.875 9.38604 15.364 7.875 13.5 7.875C11.636 7.875 10.125 9.38604 10.125 11.25C10.125 13.114 11.636 14.625 13.5 14.625Z" stroke="#307199" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                        <span class="LsubTxt">${feature.properties.adress}</span>
                                    </div>
                                    <div class="Lphone">
                                        <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M24.8749 19.4154V22.7904C24.8761 23.1037 24.812 23.4138 24.6864 23.7009C24.5609 23.988 24.3768 24.2457 24.146 24.4575C23.9151 24.6693 23.6425 24.8306 23.3457 24.9309C23.0489 25.0313 22.7344 25.0686 22.4224 25.0404C18.9606 24.6642 15.6352 23.4813 12.7136 21.5866C9.99542 19.8594 7.69087 17.5548 5.96361 14.8366C4.06234 11.9017 2.87914 8.56026 2.50986 5.08289C2.48175 4.77179 2.51872 4.45824 2.61843 4.16222C2.71813 3.86619 2.87838 3.59416 3.08898 3.36346C3.29957 3.13276 3.55589 2.94844 3.84163 2.82223C4.12736 2.69602 4.43625 2.63068 4.74861 2.63039H8.12361C8.66958 2.62502 9.19888 2.81835 9.61285 3.17436C10.0268 3.53037 10.2972 4.02477 10.3736 4.56539C10.5161 5.64546 10.7802 6.70596 11.1611 7.72664C11.3125 8.1293 11.3452 8.56692 11.2555 8.98763C11.1658 9.40834 10.9573 9.79451 10.6549 10.1004L9.22611 11.5291C10.8276 14.3456 13.1596 16.6776 15.9761 18.2791L17.4049 16.8504C17.7107 16.5479 18.0969 16.3395 18.5176 16.2497C18.9383 16.16 19.3759 16.1928 19.7786 16.3441C20.7993 16.725 21.8598 16.9892 22.9399 17.1316C23.4864 17.2087 23.9854 17.484 24.3422 17.9051C24.699 18.3261 24.8886 18.8637 24.8749 19.4154Z" stroke="#307199" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                        <span class="LsubTxt">${feature.properties.phone}</span>
                                    </div>
                                    <div class="Lwebsite">
                                        <svg width="27" height="27" viewBox="0 0 27 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M13.5 24.75C19.7132 24.75 24.75 19.7132 24.75 13.5C24.75 7.2868 19.7132 2.25 13.5 2.25C7.2868 2.25 2.25 7.2868 2.25 13.5C2.25 19.7132 7.2868 24.75 13.5 24.75Z" stroke="#307199" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M2.25 13.5H24.75" stroke="#307199" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M13.5 2.25C16.3139 5.33065 17.9131 9.32854 18 13.5C17.9131 17.6715 16.3139 21.6694 13.5 24.75C10.6861 21.6694 9.0869 17.6715 9 13.5C9.0869 9.32854 10.6861 5.33065 13.5 2.25V2.25Z" stroke="#307199" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                        <a class="LsubTxt" href="${feature.properties.website}">Visiter le site web</a>
                                    </div>
                                </div>
                            </div>
                        `
                        const closeMenu = document.querySelector('.LcloseMenu')
                        closeMenu.addEventListener("click", function(e){
                            sidepanel.classList.remove('active');
                            mymap.setView([feature.geometry.coordinates[1], feature.geometry.coordinates[0]], 14, {animation : true});
                            layer.setIcon(baseIcon)
                        })
                        const seelAllBtn = document.querySelector('.LbtnAll')
                        seelAllBtn.addEventListener("click", function(){
                            layer.setIcon(baseIcon)
                            mymap.setViewOffset([45.6284600, -1.0281000],[-140, 50],9, {animation : true})
                            sidepanel.innerHTML =`
                            <div class="LsidepanelInner">
                                <div class="Lheader">
                                    <svg class="LcloseMenuList" width="20" height="20" viewBox="0 0 123 123" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect x="19.7809" y="0.688812" width="145" height="27" rx="13.5" transform="rotate(45 19.7809 0.688812)" fill="#4D4949"/>
                                    <rect x="1.00012" y="102.53" width="145" height="27" rx="13.5" transform="rotate(-45 1.00012 102.53)" fill="#4D4949"/>
                                    </svg>
                                </div>
                                <div class="Llist">
                                    <div class="LfilterTout">Tout</div>
                                    <div class="LfilterService">Service</div>
                                    <div class="LserviceList">

                                    </div>
                                    <div class="LfilterRestauration">Pause gourmande</div>
                                    <div class="LrestaurationList">

                                    </div>
                                    <div class="LfilterHebergement">Hébergement</div>
                                    <div class="LhebergementList">

                                    </div>
                                    <div class="LfilterActivite">Visites & activités</div>
                                    <div class="LactiviteList">

                                    </div>
                                </div
                            </div>
                            `
                            const listeServiceBlock = document.querySelector('.LserviceList')
                            const listeRestaurationBlock = document.querySelector('.LrestaurationList')
                            const listeHebergementBlock = document.querySelector('.LhebergementList')
                            const listeActiviteBlock = document.querySelector('.LactiviteList')
                            const closeMenuList = document.querySelector('.LcloseMenuList')

                            closeMenuList.addEventListener("click", function(e){
                                sidepanel.classList.remove('active');
                                mymap.setViewOffset([45.6284600, -1.0281000],[-100, 20],12, {animation : true})
                                layer.setIcon(baseIcon)
                                mymap.addLayer(other)
                                mymap.addLayer(service)
                                mymap.addLayer(restauration)
                                mymap.addLayer(hebergement)
                                mymap.addLayer(activite)
                            })

                            const listTout = geojson.features.forEach((feature)=>{
                                if(feature.properties.category == 'service'){
                                    let companyName = `<div>${feature.properties.name}</div>`
                                    let box = document.createElement('div');
                                    box.innerHTML = companyName;
                                    listeServiceBlock.append(box)
                                }
                                if(feature.properties.category == 'restauration'){
                                    let companyName = `<div>${feature.properties.name}</div>`
                                    let box = document.createElement('div');
                                    box.innerHTML = companyName;
                                    listeRestaurationBlock.append(box)
                                }
                                if(feature.properties.category == 'hebergement'){
                                    let companyName = `<div>${feature.properties.name}</div>`
                                    let box = document.createElement('div');
                                    box.innerHTML = companyName;
                                    listeHebergementBlock.append(box)
                                }
                                if(feature.properties.category == 'activite'){
                                    let companyName = `<div>${feature.properties.name}</div>`
                                    let box = document.createElement('div');
                                    box.innerHTML = companyName;
                                    listeActiviteBlock.append(box)
                                }
                                listeActiviteBlock.style.display = 'none'
                                listeServiceBlock.style.display = 'none'
                                listeHebergementBlock.style.display = 'none'
                                listeRestaurationBlock.style.display = 'none'
                                listeActiviteBlock.style.display = 'none'
                            })
                            
                            const filterService = document.querySelector('.LfilterService')
                            const filterRestauration = document.querySelector('.LfilterRestauration')
                            const filterHebergement = document.querySelector('.LfilterHebergement')
                            const filterActivite = document.querySelector('.LfilterActivite')
                            const filterTout = document.querySelector('.LfilterTout')
                            const icon = document.querySelectorAll(".leaflet-marker-icon")
                            const shadow = document.querySelectorAll(".leaflet-pane.leaflet-shadow-pane")
                            

                            filterTout.addEventListener("click", function(){
                                mymap.addLayer(other)
                                mymap.addLayer(service)
                                mymap.addLayer(restauration)
                                mymap.addLayer(hebergement)
                                mymap.addLayer(activite)
                                mymap.setViewOffset([45.6284600, -1.0281000],[-100, 0],10, {animation : true})
                                layer.setIcon(baseIcon)

                                listeActiviteBlock.style.display = 'block'
                                listeRestaurationBlock.style.display = 'block'
                                listeHebergementBlock.style.display = 'block'
                                listeServiceBlock.style.display = 'block'
                                listeActiviteBlock.style.display = 'block'

                                filterActivite.classList.remove('activeFilter')
                                filterHebergement.classList.remove('activeFilter')
                                filterRestauration.classList.remove('activeFilter')
                                filterService.classList.remove('activeFilter')
                                filterTout.classList.add('activeFilter')
                            })

                            filterService.addEventListener("click", function(){
                                mymap.addLayer(service)
                                mymap.removeLayer(restauration)
                                mymap.removeLayer(hebergement)
                                mymap.removeLayer(other)
                                mymap.removeLayer(activite)
                                mymap.setViewOffset([45.6284600, -1.0281000],[-100, 0],10, {animation : true})
                                layer.setIcon(baseIcon)

                                listeActiviteBlock.style.display = 'none'
                                listeRestaurationBlock.style.display = 'none'
                                listeHebergementBlock.style.display = 'none'
                                listeServiceBlock.style.display = 'block'
                                listeActiviteBlock.style.display = 'none'

                                filterActivite.classList.remove('activeFilter')
                                filterHebergement.classList.remove('activeFilter')
                                filterRestauration.classList.remove('activeFilter')
                                filterService.classList.add('activeFilter')
                                filterTout.classList.remove('activeFilter')
                            })

                            filterRestauration.addEventListener("click", function(){
                                mymap.addLayer(restauration)
                                mymap.removeLayer(other)
                                mymap.removeLayer(service)
                                mymap.removeLayer(hebergement)
                                mymap.removeLayer(activite)
                                mymap.setViewOffset([45.6284600, -1.0281000],[-100, 0],10, {animation : true})
                                layer.setIcon(baseIcon)

                                listeActiviteBlock.style.display = 'none'
                                listeServiceBlock.style.display = 'none'
                                listeHebergementBlock.style.display = 'none'
                                listeRestaurationBlock.style.display = 'block'
                                listeActiviteBlock.style.display = 'none'

                                filterActivite.classList.remove('activeFilter')
                                filterHebergement.classList.remove('activeFilter')
                                filterRestauration.classList.add('activeFilter')
                                filterService.classList.remove('activeFilter')
                                filterTout.classList.remove('activeFilter')
                            })

                            filterHebergement.addEventListener("click", function(){
                                mymap.addLayer(hebergement)
                                mymap.removeLayer(other)
                                mymap.removeLayer(activite)
                                mymap.removeLayer(service)
                                mymap.removeLayer(restauration)
                                mymap.removeLayer(activite)
                                mymap.setViewOffset([45.6284600, -1.0281000],[-100, 0],10, {animation : true})
                                layer.setIcon(baseIcon)

                                listeActiviteBlock.style.display = 'none'
                                listeRestaurationBlock.style.display = 'none'
                                listeHebergementBlock.style.display = 'block'
                                listeServiceBlock.style.display = 'none'
                                listeActiviteBlock.style.display = 'none'

                                filterActivite.classList.remove('activeFilter')
                                filterHebergement.classList.add('activeFilter')
                                filterRestauration.classList.remove('activeFilter')
                                filterService.classList.remove('activeFilter')
                                filterTout.classList.remove('activeFilter')
                            })
                            filterActivite.addEventListener("click", function(){
                                mymap.addLayer(activite)
                                mymap.removeLayer(other)
                                mymap.removeLayer(service)
                                mymap.removeLayer(restauration)
                                mymap.removeLayer(hebergement)
                                mymap.setViewOffset([45.6284600, -1.0281000],[-100, 0],10, {animation : true})
                                layer.setIcon(baseIcon)

                                listeActiviteBlock.style.display = 'none'
                                listeRestaurationBlock.style.display = 'none'
                                listeHebergementBlock.style.display = 'none'
                                listeServiceBlock.style.display = 'none'
                                listeActiviteBlock.style.display = 'block'

                                filterActivite.classList.add('activeFilter')
                                filterHebergement.classList.remove('activeFilter')
                                filterRestauration.classList.remove('activeFilter')
                                filterService.classList.remove('activeFilter')
                                filterTout.classList.remove('activeFilter')
                            })
                        })
                    });
                    }
                }

        
        const service = L.geoJson(geojson, {
            filter: function(feature, layer) {
                return feature.properties.category == "service";
            },
            style : function(features){
                return{
                    color : '#4B65F7',
                    weight : 0.5,
                }
            },
            pointToLayer : function(geoJsonPoint, latlng){
                    return L.marker(latlng,{
                    icon : baseIcon,
                    });
            },
            onEachFeature : eachFeatureCode,
        })

        const restauration = L.geoJson(geojson, {
            filter: function(feature, layer) {
                return feature.properties.category == "restauration";
            },
            style : function(features){
                return{
                    color : '#4B65F7',
                    weight : 0.5,
                }
            },
            pointToLayer : function(geoJsonPoint, latlng){
                    return L.marker(latlng,{
                    icon : baseIcon,
                    });
            },
            onEachFeature : eachFeatureCode,
        })

        const hebergement = L.geoJson(geojson, {
            filter: function(feature, layer) {
                return feature.properties.category == "hebergement";
            },
            style : function(features){
                return{
                    color : '#4B65F7',
                    weight : 0.5,
                }
            },
            pointToLayer : function(geoJsonPoint, latlng){
                    return L.marker(latlng,{
                    icon : baseIcon,
                    });
            },
            onEachFeature : eachFeatureCode,
        })

        const activite = L.geoJson(geojson, {
            filter: function(feature, layer) {
                return feature.properties.category == "activite";
            },
            style : function(features){
                return{
                    color : '#4B65F7',
                    weight : 0.5,
                }
            },
            pointToLayer : function(geoJsonPoint, latlng){
                    return L.marker(latlng,{
                    icon : baseIcon,
                    });
            },
            onEachFeature : eachFeatureCode,
        })

        const other = L.geoJson(geojson, {
            filter: function(feature, layer) {
                return feature.properties.category == "";
            },
            style : function(features){
                return{
                    color : '#4B65F7',
                    weight : 0.5,
                }
            },
            pointToLayer : function(geoJsonPoint, latlng){
                    return L.marker(latlng,{
                    icon : baseIcon,
                    });
            },
            onEachFeature : eachFeatureCode,
        })
        service.addTo(mymap)
        restauration.addTo(mymap)
        hebergement.addTo(mymap)
        activite.addTo(mymap)
        other.addTo(mymap)
    })
    .catch(err => console.log(err))

</script>

</html>